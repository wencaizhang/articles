<!doctype html><html lang=zh-hans><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=author content="前端果酱"><meta name=description content="Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中
Axios 有以下特点：
 支持浏览器和node.js 支持promise 能拦截请求和响应 能转换请求和响应数据 能取消请求 自动转换JSON数据 浏览器端支持防止CSRF(跨站请求伪造)  axios 的详细使用都可以在 https://github.com/axios/axios 中看到，本文主要将在项目实践中如何进一步封装 axios ，使得 axios 更符合实际需求。
封装步骤 全局配置 全局配置是指配置 baseURL timeout 等选项。"><link rel=alternate hreflang=zh-hans href=/post/2019/2019-11-22-request-methods-with-axios/><meta name=theme-color content="#2962ff"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png><link rel=canonical href=/post/2019/2019-11-22-request-methods-with-axios/><meta property="twitter:card" content="summary"><meta property="og:site_name" content="阿文的网络空间"><meta property="og:url" content="/post/2019/2019-11-22-request-methods-with-axios/"><meta property="og:title" content="Request Methods With Axios | 阿文的网络空间"><meta property="og:description" content="Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中
Axios 有以下特点：
 支持浏览器和node.js 支持promise 能拦截请求和响应 能转换请求和响应数据 能取消请求 自动转换JSON数据 浏览器端支持防止CSRF(跨站请求伪造)  axios 的详细使用都可以在 https://github.com/axios/axios 中看到，本文主要将在项目实践中如何进一步封装 axios ，使得 axios 更符合实际需求。
封装步骤 全局配置 全局配置是指配置 baseURL timeout 等选项。"><meta property="og:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="twitter:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="zh-Hans"><meta property="article:published_time" content="2019-11-22T15:46:45+08:00"><meta property="article:modified_time" content="2019-11-22T15:46:45+08:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/post/2019/2019-11-22-request-methods-with-axios/"},"headline":"Request Methods With Axios","datePublished":"2019-11-22T15:46:45+08:00","dateModified":"2019-11-22T15:46:45+08:00","author":{"@type":"Person","name":"前端果酱"},"publisher":{"@type":"Organization","name":"阿文的网络空间","logo":{"@type":"ImageObject","url":"/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png"}},"description":"Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中\nAxios 有以下特点：\n 支持浏览器和node.js 支持promise 能拦截请求和响应 能转换请求和响应数据 能取消请求 自动转换JSON数据 浏览器端支持防止CSRF(跨站请求伪造)  axios 的详细使用都可以在 https://github.com/axios/axios 中看到，本文主要将在项目实践中如何进一步封装 axios ，使得 axios 更符合实际需求。\n封装步骤 全局配置 全局配置是指配置 baseURL timeout 等选项。"}</script><title>Request Methods With Axios | 阿文的网络空间</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>搜索</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=搜索... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>阿文的网络空间</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>阿文的网络空间</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#posts><span>技术文章</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>个人项目</span></a></li><li class=nav-item><a class=nav-link href=/doc><span>我的文档</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class="nav-link js-theme-selector" data-toggle=dropdown aria-haspopup=true><i class="fas fa-palette" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav><article class=article><div class="article-container pt-3"><h1>Request Methods With Axios</h1><div class=article-metadata><span class=article-date>Nov 22, 2019</span>
<span class=middot-divider></span><span class=article-reading-time>3 分钟阅读时长</span></div></div><div class=article-container><div class=article-style><p>Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中</p><p>Axios 有以下特点：</p><ul><li>支持浏览器和node.js</li><li>支持promise</li><li>能拦截请求和响应</li><li>能转换请求和响应数据</li><li>能取消请求</li><li>自动转换JSON数据</li><li>浏览器端支持防止CSRF(跨站请求伪造)</li></ul><p>axios 的详细使用都可以在
<a href=https://github.com/axios/axios target=_blank rel=noopener>https://github.com/axios/axios</a> 中看到，本文主要将在项目实践中如何进一步封装 axios ，使得 axios 更符合实际需求。</p><h2 id=封装步骤>封装步骤</h2><h3 id=全局配置>全局配置</h3><p>全局配置是指配置 <code>baseURL</code> <code>timeout</code> 等选项。</p><p>全局配置会影响到每个请求，可以直接对 axios 配置，也可以创建 axios 的实例，对实例进行配置。</p><p>axios 和 axios 实例的区别就在于，axios 可以创建多个实例，不同实例之间的配置可以不同，并且不会影响到 axios 这个源头。</p><p>直接配置 axios：</p><pre><code class=language-js>axios.defaults.baseURL = 'https://api.example.com';
axios.defaults.timeout = 2000;
</code></pre><p>或者配置 axios 实例：</p><pre><code class=language-js>import axios from &quot;axios&quot;;

// 创建 axios 实例
const request = axios.create({
  baseURL: &quot;https://api.example.com&quot;,
  timeout: 2000, // 请求超时时间
});
</code></pre><h3 id=拦截器>拦截器</h3><p>axios 拦截器分为「请求拦截器」和「响应拦截器」，它们相当于是项目 http 请求的大门。</p><p>每次发送请求时要经过「请求拦截器」这道门，每次请求得到响应时也要经过「响应拦截器」这道门。</p><p>有了拦截器，方便我们对每个请求进行一些处理，比如：</p><ol><li>发送请求时，判断用户的登录状态或者用户权限，不满足条件的或者跳转登录页面或者弹窗提示</li><li>发送请求时，添加特定的 headers</li><li>请求得到响应时，根据响应状态码做不同处理：<ul><li>200: 响应成功</li><li>404: 未找到资源</li><li>409: 用户没有相应权限</li></ul></li></ol><pre><code class=language-js>import axios from &quot;axios&quot;;

// 创建 axios 实例
const request = axios.create({
  baseURL: &quot;[/cmp/v1](https://api.example.com)&quot;,
  timeout: 2000 // 请求超时时间
});


// request 拦截器
request.interceptors.request.use(
  confit =&gt; {
    // 设置 token，或者其他设置
    config.headers[&quot;token&quot;] = 'token_123';
    return config;
  },
  err =&gt; {
    return Promise.reject(err)
  },
);

// response 拦截器
request.interceptors.response.use(
  resp =&gt; resp.data,
  error =&gt; {
    if (error.response) {
      const data = error.response.data;
      let msg = data.desc || data.exception || '';

      switch (error.response.status) {
        case 401:
          // 提示：登录过期，跳转登录页面重新登录
          break;
        case 403:
          // 提示：权限不足
          break;
        case 404:
          // 提示：资源不存在
          break;
        default:
          // 提示：请求失败
          break;
      }
    }
    return Promise.reject(error);
  }
);
</code></pre><h3 id=封装各类型请求>封装各类型请求</h3><p>这一步封装主要是为了统一 axios 中不同请求类型的参数要求。</p><p>以 POST 和 GET 为例，封装之前</p><pre><code class=language-js>const payload = { ID: 12345 }

// get 请求，params 属性值是携带的参数
axios.get('/user', {
  params: payload
})
// post 请求
axios.post('/user', payload)
</code></pre><p>封装之后：</p><pre><code class=language-js>const payload = { ID: 12345 }

GET('/user', payload)
POST('/user', payload)
</code></pre><p>封装之后，每种类型的请求方法都接受两个参数：url 和需要传递到服务端的数据 payload。</p><p>这里我封装了 <code>GET</code> <code>POST</code> <code>PUT</code> <code>DELETE</code> 四种方法，分别对应 <code>get</code> <code>post</code> <code>put</code> <code>delete</code> 类型的请求：</p><pre><code class=language-js>export function GET (url, payload) {
  return request.get(url, {
    params: payload
  });
}

export function POST (url, payload) {
  return request.post(url, payload);
}

export function PUT (url, payload) {
  return request.put(url, payload);
}

export function DELETE (url, payload) {
  return request.delete(url, {
    data: payload
  });
}
</code></pre><p>使用方法：</p><pre><code class=language-js>// 示例：
import { GET, POST, PUT, DELETE } from '@/utils/request.js'

const payload = { username: 'admin', password: '123456' }
POST('/login', payload)
  .then(resp =&gt; {
    // 请求成功
  })
  .catch(err =&gt; {
    // 请求失败
  })
  .finally {
    // 成功/失败都会执行这里代码
  }
</code></pre><h2 id=其他>其他</h2><h3 id=post-请求数据格式>post 请求数据格式</h3><p>默认情况下，axios 中 post 请求的 <code>Content-Type</code> 字段对应的值是 <code>application/json</code> ，此时是以 json 格式向服务端发送数据。</p><p>如果想要以 <code>FormData</code> 形式发送数据，你可以这样解决</p><pre><code class=language-js>import axios from &quot;axios&quot;;
import qs from 'qs';
const data = { 'bar': 123 };
const options = {
  url,
  method: 'POST',
  data: qs.stringify(data),
  headers: { 'content-type': 'application/x-www-form-urlencoded' },
};
axios(options);
</code></pre><p>那么前面对 POST 方法的封装也要进行修改：</p><pre><code class=language-js>import qs from 'qs';
export function POST (url, payload) {
  const options = {
    url,
    method: 'POST',
    data: qs.stringify(data),
    headers: { 'content-type': 'application/x-www-form-urlencoded' },
  };
  return request(options);
}
</code></pre><h3 id=挂载到-vue-原型上>挂载到 vue 原型上</h3><pre><code class=language-js>import { GET, POST, PUT, DELETE } from '@/utils/request.js'
Vue.prototype.$http = {
  get: GET,
  post: POST,
  put: PUT,
  delete: DELETE
}
</code></pre><p>挂载到原型上之后，就可以在任意的 vue 组件内通过 vue 实例调用请求：</p><pre><code class=language-js>this.$http.get('/user', { id: 123 })
</code></pre><h2 id=完整代码>完整代码</h2><details><summary>完整的 request.js 代码在此，请点击展开完整代码</summary><pre><code class=language-js>// request.js
import axios from &quot;axios&quot;;

// 创建 axios 实例
const request = axios.create({
  baseURL: &quot;https://api.example.com&quot;,
  timeout: 2000, // 请求超时时间
});

// request 拦截器
request.interceptors.request.use(
  confit =&gt; {
    // 设置 token，或者其他设置
    config.headers[&quot;token&quot;] = 'token_123';
    return config;
  },
  err =&gt; {
    return Promise.reject(err)
  },
);

// response 拦截器
request.interceptors.response.use(
  resp =&gt; resp.data,
  error =&gt; {
    if (error.response) {
      const data = error.response.data;
      let msg = data.desc || data.exception || '';

      switch (error.response.status) {
        case 401:
          // 提示：登录过期，跳转登录页面重新登录
          break;
        case 403:
          // 提示：权限不足
          break;
        case 404:
          // 提示：资源不存在
          break;
        default:
          // 提示：请求失败
          break;
      }
    }
    return Promise.reject(error);
  }
);

export function GET (url, payload) {
  return request.get(url, {
    params: payload
  });
}

export function POST (url, payload) {
  return request.post(url, payload);
}

export function PUT (url, payload) {
  return request.put(url, payload);
}
export function PATCH (url, payload) {
  return request.patch(url, payload);
}

export function DELETE (url, payload) {
  return request.delete(url, {
    params: payload
  });
}
</code></pre></details><hr><p>本文完，感谢阅读。😜</p></div><div class=article-tags><a class="badge badge-light" href=/tag/ajax/>ajax</a>
<a class="badge badge-light" href=/tag/axios/>axios</a></div><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=/post/2019/2019-11-22-request-methods-with-axios/&text=Request%20Methods%20With%20Axios" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=/post/2019/2019-11-22-request-methods-with-axios/&t=Request%20Methods%20With%20Axios" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Request%20Methods%20With%20Axios&body=/post/2019/2019-11-22-request-methods-with-axios/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=/post/2019/2019-11-22-request-methods-with-axios/&title=Request%20Methods%20With%20Axios" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Request%20Methods%20With%20Axios%20/post/2019/2019-11-22-request-methods-with-axios/" target=_blank rel=noopener class=share-btn-whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=/post/2019/2019-11-22-request-methods-with-axios/&title=Request%20Methods%20With%20Axios" target=_blank rel=noopener class=share-btn-weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><img class="avatar mr-3 avatar-circle" src=/author/%E5%89%8D%E7%AB%AF%E6%9E%9C%E9%85%B1/avatar_hu52a603635ecebd45650b162dadabb4e5_12861_270x270_fill_q90_lanczos_center.jpg alt=前端果酱><div class=media-body><h5 class=card-title><a href=/>前端果酱</a></h5><h6 class=card-subtitle>前端开发工程师</h6><p class=card-text>擅长 HTML、CSS、JavaScript、Vue.js.</p><ul class=network-icon aria-hidden=true><li><a href=https://github.com/wencaizhang target=_blank rel=noopener><i class="fab fa-github"></i></a></li></ul></div></div></div></article><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script><script>const code_highlighting=true;</script><script>const isSiteThemeDark=false;</script><script>const search_config={"indexURI":"/index.json","minLength":1,"threshold":0.3};const i18n={"no_results":"没有找到结果","placeholder":"搜索...","results":"搜索结果"};const content_type={'post':"文章",'project':"项目",'publication':"出版物",'talk':"演讲",'slides':"演示文稿"};</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.66c553246b0f279a03be6e5597f72b52.js></script><div class=container><footer class=site-footer><p class=powered-by></p><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# class=back-to-top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p><p>本站由
<a style=display:inline-block;vertical-align:bottom href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><img style=height:30px src=/img/upyun_logos/又拍云_logo2.png alt></a>
提供CDN加速/云存储服务</p></footer></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>引用</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>复制</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>下载</a><div id=modal-error></div></div></div></div></div></body></html>